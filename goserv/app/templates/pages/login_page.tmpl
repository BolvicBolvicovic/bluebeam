<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100" onload="OnLoad()">
    {{template "navbar" .Navbar}}
    <div>
      <div>
        {{template "input" .UsernameInput}}
        {{template "input" .PasswordInput}}
        {{template "button" .SubmitButton}}
        <div id="messageOutput"></div>
      </div>
    </div>
    <script>
    function OnLoad() {
      document.getElementById("submitButton").addEventListener("click", (e) => {
        e.preventDefault();
        let body = JSON.stringify({
          username: document.getElementById("username").value,
          password: document.getElementById("password").value,
        });
        fetch('https://localhost/login', {
          method: 'POST',
          mode: 'cors',
          headers: { 'Content-Type': 'application/json' },
          body: body
        })
        .then(response => response.text())
          .then(data => {
            const jsonData = JSON.parse(data);
            if (jsonData.error != undefined) {
              document.getElementById("messageOutput").innerText = jsonData.error;
            } else {
              document.location.href = "https://localhost";
            }
        })
        .catch(error => console.error('Error sending data:', error));
      });
    }
    </script>
  </body>
</html>
